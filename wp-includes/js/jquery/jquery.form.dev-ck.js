/*!
 * jQuery Form Plugin
 * version: 2.73 (03-MAY-2011)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */(function(e){function t(){if(e.fn.ajaxSubmit.debug){var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}}e.fn.ajaxSubmit=function(n){function g(){function m(){var t=c.attr("target"),n=c.attr("action");r.setAttribute("target",s);r.getAttribute("method")!="POST"&&r.setAttribute("method","POST");r.getAttribute("action")!=i.url&&r.setAttribute("action",i.url);i.skipEncodingOverride||c.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});i.timeout&&(p=setTimeout(function(){h=!0;E(!0)},i.timeout));var o=[];try{if(i.extraData)for(var f in i.extraData)o.push(e('<input type="hidden" name="'+f+'" value="'+i.extraData[f]+'" />').appendTo(r)[0]);u.appendTo("body");a.attachEvent?a.attachEvent("onload",E):a.addEventListener("load",E,!1);r.submit()}finally{r.setAttribute("action",n);t?r.setAttribute("target",t):c.removeAttr("target");e(o).remove()}}function E(n){if(f.aborted||w)return;if(n===!0&&f){f.abort("timeout");return}var r=a.contentWindow?a.contentWindow.document:a.contentDocument?a.contentDocument:a.document;if(!r||r.location.href==i.iframeSrc)if(!h)return;a.detachEvent?a.detachEvent("onload",E):a.removeEventListener("load",E,!1);var s=!0;try{if(h)throw"timeout";var o=i.dataType=="xml"||r.XMLDocument||e.isXMLDoc(r);t("isXml="+o);if(!o&&window.opera&&(r.body==null||r.body.innerHTML=="")&&--b){t("requeing onLoad callback, DOM not available");setTimeout(E,250);return}f.responseText=r.body?r.body.innerHTML:r.documentElement?r.documentElement.innerHTML:null;f.responseXML=r.XMLDocument?r.XMLDocument:r;o&&(i.dataType="xml");f.getResponseHeader=function(e){var t={"content-type":i.dataType};return t[e]};var c=/(json|script|text)/.test(i.dataType);if(c||i.textarea){var d=r.getElementsByTagName("textarea")[0];if(d)f.responseText=d.value;else if(c){var v=r.getElementsByTagName("pre")[0],m=r.getElementsByTagName("body")[0];v?f.responseText=v.textContent:m&&(f.responseText=m.innerHTML)}}else i.dataType=="xml"&&!f.responseXML&&f.responseText!=null&&(f.responseXML=S(f.responseText));g=T(f,i.dataType,i)}catch(n){t("error caught:",n);s=!1;f.error=n;i.error&&i.error.call(i.context,f,"error",n);l&&e.event.trigger("ajaxError",[f,i,n])}if(f.aborted){t("upload aborted");s=!1}if(s){i.success&&i.success.call(i.context,g,"success",f);l&&e.event.trigger("ajaxSuccess",[f,i])}l&&e.event.trigger("ajaxComplete",[f,i]);l&&!--e.active&&e.event.trigger("ajaxStop");i.complete&&i.complete.call(i.context,f,s?"success":"error");w=!0;i.timeout&&clearTimeout(p);setTimeout(function(){u.removeData("form-plugin-onload");u.remove();f.responseXML=null},100)}var r=c[0];if(e(":input[name=submit],:input[id=submit]",r).length){alert('Error: Form elements must not have name or id of "submit".');return}var i=e.extend(!0,{},e.ajaxSettings,n);i.context=i.context||i;var s="jqFormIO"+(new Date).getTime(),o="_"+s,u=e('<iframe id="'+s+'" name="'+s+'" src="'+i.iframeSrc+'" />'),a=u[0];u.css({position:"absolute",top:"-1000px",left:"-1000px"});var f={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(n){var r=n==="timeout"?"timeout":"aborted";t("aborting upload... "+r);this.aborted=1;u.attr("src",i.iframeSrc);f.error=r;i.error&&i.error.call(i.context,f,r,r);l&&e.event.trigger("ajaxError",[f,i,r]);i.complete&&i.complete.call(i.context,f,r)}},l=i.global;l&&!(e.active++)&&e.event.trigger("ajaxStart");l&&e.event.trigger("ajaxSend",[f,i]);if(i.beforeSend&&i.beforeSend.call(i.context,f,i)===!1){i.global&&e.active--;return}if(f.aborted)return;var h=0,p,d=r.clk;if(d){var v=d.name;if(v&&!d.disabled){i.extraData=i.extraData||{};i.extraData[v]=d.value;if(d.type=="image"){i.extraData[v+".x"]=r.clk_x;i.extraData[v+".y"]=r.clk_y}}}i.forceSync?m():setTimeout(m,10);var g,y,b=50,w,S=e.parseXML||function(e,t){if(window.ActiveXObject){t=new ActiveXObject("Microsoft.XMLDOM");t.async="false";t.loadXML(e)}else t=(new DOMParser).parseFromString(e,"text/xml");return t&&t.documentElement&&t.documentElement.nodeName!="parsererror"?t:null},x=e.parseJSON||function(e){return window.eval("("+e+")")},T=function(t,n,r){var i=t.getResponseHeader("content-type")||"",s=n==="xml"||!n&&i.indexOf("xml")>=0,o=s?t.responseXML:t.responseText;s&&o.documentElement.nodeName==="parsererror"&&e.error&&e.error("parsererror");r&&r.dataFilter&&(o=r.dataFilter(o,n));typeof o=="string"&&(n==="json"||!n&&i.indexOf("json")>=0?o=x(o):(n==="script"||!n&&i.indexOf("javascript")>=0)&&e.globalEval(o));return o}}if(!this.length){t("ajaxSubmit: skipping submit process - no element selected");return this}typeof n=="function"&&(n={success:n});var r=this.attr("action"),i=typeof r=="string"?e.trim(r):"";i&&(i=(i.match(/^([^#]+)/)||[])[1]);i=i||window.location.href||"";n=e.extend(!0,{url:i,success:e.ajaxSettings.success,type:this[0].getAttribute("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},n);var s={};this.trigger("form-pre-serialize",[this,n,s]);if(s.veto){t("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(n.beforeSerialize&&n.beforeSerialize(this,n)===!1){t("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var o,u,a=this.formToArray(n.semantic);if(n.data){n.extraData=n.data;for(o in n.data)if(n.data[o]instanceof Array)for(var f in n.data[o])a.push({name:o,value:n.data[o][f]});else{u=n.data[o];u=e.isFunction(u)?u():u;a.push({name:o,value:u})}}if(n.beforeSubmit&&n.beforeSubmit(a,this,n)===!1){t("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[a,this,n,s]);if(s.veto){t("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var l=e.param(a);if(n.type.toUpperCase()=="GET"){n.url+=(n.url.indexOf("?")>=0?"&":"?")+l;n.data=null}else n.data=l;var c=this,h=[];n.resetForm&&h.push(function(){c.resetForm()});n.clearForm&&h.push(function(){c.clearForm()});if(!n.dataType&&n.target){var p=n.success||function(){};h.push(function(t){var r=n.replaceTarget?"replaceWith":"html";e(n.target)[r](t).each(p,arguments)})}else n.success&&h.push(n.success);n.success=function(e,t,r){var i=n.context||n;for(var s=0,o=h.length;s<o;s++)h[s].apply(i,[e,t,r||c,c])};var d=e("input:file",this).length>0,v="multipart/form-data",m=c.attr("enctype")==v||c.attr("encoding")==v;n.iframe!==!1&&(d||n.iframe||m)?n.closeKeepAlive?e.get(n.closeKeepAlive,g):g():e.ajax(n);this.trigger("form-submit-notify",[this,n]);return this};e.fn.ajaxForm=function(n){if(this.length===0){var r={s:this.selector,c:this.context};if(!e.isReady&&r.s){t("DOM not ready, queuing ajaxForm");e(function(){e(r.s,r.c).ajaxForm(n)});return this}t("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(t){if(!t.isDefaultPrevented()){t.preventDefault();e(this).ajaxSubmit(n)}}).bind("click.form-plugin",function(t){var n=t.target,r=e(n);if(!r.is(":submit,input:image")){var i=r.closest(":submit");if(i.length==0)return;n=i[0]}var s=this;s.clk=n;if(n.type=="image")if(t.offsetX!=undefined){s.clk_x=t.offsetX;s.clk_y=t.offsetY}else if(typeof e.fn.offset=="function"){var o=r.offset();s.clk_x=t.pageX-o.left;s.clk_y=t.pageY-o.top}else{s.clk_x=t.pageX-n.offsetLeft;s.clk_y=t.pageY-n.offsetTop}setTimeout(function(){s.clk=s.clk_x=s.clk_y=null},100)})};e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};e.fn.formToArray=function(t){var n=[];if(this.length===0)return n;var r=this[0],i=t?r.getElementsByTagName("*"):r.elements;if(!i)return n;var s,o,u,a,f,l,c;for(s=0,l=i.length;s<l;s++){f=i[s];u=f.name;if(!u)continue;if(t&&r.clk&&f.type=="image"){if(!f.disabled&&r.clk==f){n.push({name:u,value:e(f).val()});n.push({name:u+".x",value:r.clk_x},{name:u+".y",value:r.clk_y})}continue}a=e.fieldValue(f,!0);if(a&&a.constructor==Array)for(o=0,c=a.length;o<c;o++)n.push({name:u,value:a[o]});else a!==null&&typeof a!="undefined"&&n.push({name:u,value:a})}if(!t&&r.clk){var h=e(r.clk),p=h[0];u=p.name;if(u&&!p.disabled&&p.type=="image"){n.push({name:u,value:h.val()});n.push({name:u+".x",value:r.clk_x},{name:u+".y",value:r.clk_y})}}return n};e.fn.formSerialize=function(t){return e.param(this.formToArray(t))};e.fn.fieldSerialize=function(t){var n=[];this.each(function(){var r=this.name;if(!r)return;var i=e.fieldValue(this,t);if(i&&i.constructor==Array)for(var s=0,o=i.length;s<o;s++)n.push({name:r,value:i[s]});else i!==null&&typeof i!="undefined"&&n.push({name:this.name,value:i})});return e.param(n)};e.fn.fieldValue=function(t){for(var n=[],r=0,i=this.length;r<i;r++){var s=this[r],o=e.fieldValue(s,t);if(o===null||typeof o=="undefined"||o.constructor==Array&&!o.length)continue;o.constructor==Array?e.merge(n,o):n.push(o)}return n};e.fieldValue=function(t,n){var r=t.name,i=t.type,s=t.tagName.toLowerCase();n===undefined&&(n=!0);if(n&&(!r||t.disabled||i=="reset"||i=="button"||(i=="checkbox"||i=="radio")&&!t.checked||(i=="submit"||i=="image")&&t.form&&t.form.clk!=t||s=="select"&&t.selectedIndex==-1))return null;if(s=="select"){var o=t.selectedIndex;if(o<0)return null;var u=[],a=t.options,f=i=="select-one",l=f?o+1:a.length;for(var c=f?o:0;c<l;c++){var h=a[c];if(h.selected){var p=h.value;p||(p=h.attributes&&h.attributes.value&&!h.attributes.value.specified?h.text:h.value);if(f)return p;u.push(p)}}return u}return e(t).val()};e.fn.clearForm=function(){return this.each(function(){e("input,select,textarea",this).clearFields()})};e.fn.clearFields=e.fn.clearInputs=function(){return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();e=="text"||e=="password"||t=="textarea"?this.value="":e=="checkbox"||e=="radio"?this.checked=!1:t=="select"&&(this.selectedIndex=-1)})};e.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})};e.fn.enable=function(e){e===undefined&&(e=!0);return this.each(function(){this.disabled=!e})};e.fn.selected=function(t){t===undefined&&(t=!0);return this.each(function(){var n=this.type;if(n=="checkbox"||n=="radio")this.checked=t;else if(this.tagName.toLowerCase()=="option"){var r=e(this).parent("select");t&&r[0]&&r[0].type=="select-one"&&r.find("option").selected(!1);this.selected=t}})}})(jQuery);