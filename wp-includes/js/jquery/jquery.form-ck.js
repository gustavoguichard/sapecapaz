/*!
 * jQuery Form Plugin
 * version: 2.73 (03-MAY-2011)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */(function(e){function t(){if(e.fn.ajaxSubmit.debug){var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}}e.fn.ajaxSubmit=function(n){function y(){function g(){var t=h.attr("target"),n=h.attr("action");r.setAttribute("target",s);r.getAttribute("method")!="POST"&&r.setAttribute("method","POST");r.getAttribute("action")!=i.url&&r.setAttribute("action",i.url);i.skipEncodingOverride||h.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});i.timeout&&(d=setTimeout(function(){p=!0;x(!0)},i.timeout));var o=[];try{if(i.extraData)for(var a in i.extraData)o.push(e('<input type="hidden" name="'+a+'" value="'+i.extraData[a]+'" />').appendTo(r)[0]);u.appendTo("body");f.attachEvent?f.attachEvent("onload",x):f.addEventListener("load",x,!1);r.submit()}finally{r.setAttribute("action",n);t?r.setAttribute("target",t):h.removeAttr("target");e(o).remove()}}function x(n){if(l.aborted||S)return;if(n===!0&&l){l.abort("timeout");return}var r=f.contentWindow?f.contentWindow.document:f.contentDocument?f.contentDocument:f.document;if(!r||r.location.href==i.iframeSrc)if(!p)return;f.detachEvent?f.detachEvent("onload",x):f.removeEventListener("load",x,!1);var s=!0;try{if(p)throw"timeout";var o=i.dataType=="xml"||r.XMLDocument||e.isXMLDoc(r);t("isXml="+o);if(!o&&window.opera&&(r.body==null||r.body.innerHTML=="")&&--E){t("requeing onLoad callback, DOM not available");setTimeout(x,250);return}l.responseText=r.body?r.body.innerHTML:r.documentElement?r.documentElement.innerHTML:null;l.responseXML=r.XMLDocument?r.XMLDocument:r;o&&(i.dataType="xml");l.getResponseHeader=function(e){var t={"content-type":i.dataType};return t[e]};var h=/(json|script|text)/.test(i.dataType);if(h||i.textarea){var v=r.getElementsByTagName("textarea")[0];if(v)l.responseText=v.value;else if(h){var m=r.getElementsByTagName("pre")[0],g=r.getElementsByTagName("body")[0];m?l.responseText=m.textContent:g&&(l.responseText=g.innerHTML)}}else i.dataType=="xml"&&!l.responseXML&&l.responseText!=null&&(l.responseXML=T(l.responseText));y=C(l,i.dataType,i)}catch(n){t("error caught:",n);s=!1;l.error=n;i.error&&i.error.call(i.context,l,"error",n);c&&e.event.trigger("ajaxError",[l,i,n])}if(l.aborted){t("upload aborted");s=!1}if(s){i.success&&i.success.call(i.context,y,"success",l);c&&e.event.trigger("ajaxSuccess",[l,i])}c&&e.event.trigger("ajaxComplete",[l,i]);c&&!--e.active&&e.event.trigger("ajaxStop");i.complete&&i.complete.call(i.context,l,s?"success":"error");S=!0;i.timeout&&clearTimeout(d);setTimeout(function(){u.removeData("form-plugin-onload");u.remove();l.responseXML=null},100)}var r=h[0];if(e(":input[name=submit],:input[id=submit]",r).length){alert('Error: Form elements must not have name or id of "submit".');return}var i=e.extend(!0,{},e.ajaxSettings,n);i.context=i.context||i;var s="jqFormIO"+(new Date).getTime(),o="_"+s,u=e('<iframe id="'+s+'" name="'+s+'" src="'+i.iframeSrc+'" />'),f=u[0];u.css({position:"absolute",top:"-1000px",left:"-1000px"});var l={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(n){var r=n==="timeout"?"timeout":"aborted";t("aborting upload... "+r);this.aborted=1;u.attr("src",i.iframeSrc);l.error=r;i.error&&i.error.call(i.context,l,r,r);c&&e.event.trigger("ajaxError",[l,i,r]);i.complete&&i.complete.call(i.context,l,r)}},c=i.global;c&&!(e.active++)&&e.event.trigger("ajaxStart");c&&e.event.trigger("ajaxSend",[l,i]);if(i.beforeSend&&i.beforeSend.call(i.context,l,i)===!1){i.global&&e.active--;return}if(l.aborted)return;var p=0,d,v=r.clk;if(v){var m=v.name;if(m&&!v.disabled){i.extraData=i.extraData||{};i.extraData[m]=v.value;if(v.type=="image"){i.extraData[m+".x"]=r.clk_x;i.extraData[m+".y"]=r.clk_y}}}i.forceSync?g():setTimeout(g,10);var y,w,E=50,S,T=e.parseXML||function(e,t){if(window.ActiveXObject){t=new ActiveXObject("Microsoft.XMLDOM");t.async="false";t.loadXML(e)}else t=(new DOMParser).parseFromString(e,"text/xml");return t&&t.documentElement&&t.documentElement.nodeName!="parsererror"?t:null},N=e.parseJSON||function(e){return window.eval("("+e+")")},C=function(t,n,r){var i=t.getResponseHeader("content-type")||"",s=n==="xml"||!n&&i.indexOf("xml")>=0,o=s?t.responseXML:t.responseText;s&&o.documentElement.nodeName==="parsererror"&&e.error&&e.error("parsererror");r&&r.dataFilter&&(o=r.dataFilter(o,n));typeof o=="string"&&(n==="json"||!n&&i.indexOf("json")>=0?o=N(o):(n==="script"||!n&&i.indexOf("javascript")>=0)&&e.globalEval(o));return o}}if(!this.length){t("ajaxSubmit: skipping submit process - no element selected");return this}typeof n=="function"&&(n={success:n});var r=this.attr("action"),i=typeof r=="string"?e.trim(r):"";i&&(i=(i.match(/^([^#]+)/)||[])[1]);i=i||window.location.href||"";n=e.extend(!0,{url:i,success:e.ajaxSettings.success,type:this[0].getAttribute("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},n);var s={};this.trigger("form-pre-serialize",[this,n,s]);if(s.veto){t("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(n.beforeSerialize&&n.beforeSerialize(this,n)===!1){t("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var o,u,f=this.formToArray(n.semantic);if(n.data){n.extraData=n.data;for(o in n.data)if(n.data[o]instanceof Array)for(var l in n.data[o])f.push({name:o,value:n.data[o][l]});else{u=n.data[o];u=e.isFunction(u)?u():u;f.push({name:o,value:u})}}if(n.beforeSubmit&&n.beforeSubmit(f,this,n)===!1){t("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[f,this,n,s]);if(s.veto){t("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var c=e.param(f);if(n.type.toUpperCase()=="GET"){n.url+=(n.url.indexOf("?")>=0?"&":"?")+c;n.data=null}else n.data=c;var h=this,p=[];n.resetForm&&p.push(function(){h.resetForm()});n.clearForm&&p.push(function(){h.clearForm()});if(!n.dataType&&n.target){var d=n.success||function(){};p.push(function(t){var r=n.replaceTarget?"replaceWith":"html";e(n.target)[r](t).each(d,arguments)})}else n.success&&p.push(n.success);n.success=function(e,t,r){var i=n.context||n;for(var s=0,o=p.length;s<o;s++)p[s].apply(i,[e,t,r||h,h])};var v=e("input:file",this).length>0,m="multipart/form-data",g=h.attr("enctype")==m||h.attr("encoding")==m;n.iframe!==!1&&(v||n.iframe||g)?n.closeKeepAlive?e.get(n.closeKeepAlive,y):y():e.ajax(n);this.trigger("form-submit-notify",[this,n]);return this};e.fn.ajaxForm=function(n){if(this.length===0){var r={s:this.selector,c:this.context};if(!e.isReady&&r.s){t("DOM not ready, queuing ajaxForm");e(function(){e(r.s,r.c).ajaxForm(n)});return this}t("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(t){if(!t.isDefaultPrevented()){t.preventDefault();e(this).ajaxSubmit(n)}}).bind("click.form-plugin",function(t){var n=t.target,r=e(n);if(!r.is(":submit,input:image")){var i=r.closest(":submit");if(i.length==0)return;n=i[0]}var s=this;s.clk=n;if(n.type=="image")if(t.offsetX!=undefined){s.clk_x=t.offsetX;s.clk_y=t.offsetY}else if(typeof e.fn.offset=="function"){var o=r.offset();s.clk_x=t.pageX-o.left;s.clk_y=t.pageY-o.top}else{s.clk_x=t.pageX-n.offsetLeft;s.clk_y=t.pageY-n.offsetTop}setTimeout(function(){s.clk=s.clk_x=s.clk_y=null},100)})};e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};e.fn.formToArray=function(t){var n=[];if(this.length===0)return n;var r=this[0],i=t?r.getElementsByTagName("*"):r.elements;if(!i)return n;var s,o,u,a,f,l,c;for(s=0,l=i.length;s<l;s++){f=i[s];u=f.name;if(!u)continue;if(t&&r.clk&&f.type=="image"){if(!f.disabled&&r.clk==f){n.push({name:u,value:e(f).val()});n.push({name:u+".x",value:r.clk_x},{name:u+".y",value:r.clk_y})}continue}a=e.fieldValue(f,!0);if(a&&a.constructor==Array)for(o=0,c=a.length;o<c;o++)n.push({name:u,value:a[o]});else a!==null&&typeof a!="undefined"&&n.push({name:u,value:a})}if(!t&&r.clk){var h=e(r.clk),p=h[0];u=p.name;if(u&&!p.disabled&&p.type=="image"){n.push({name:u,value:h.val()});n.push({name:u+".x",value:r.clk_x},{name:u+".y",value:r.clk_y})}}return n};e.fn.formSerialize=function(t){return e.param(this.formToArray(t))};e.fn.fieldSerialize=function(t){var n=[];this.each(function(){var r=this.name;if(!r)return;var i=e.fieldValue(this,t);if(i&&i.constructor==Array)for(var s=0,o=i.length;s<o;s++)n.push({name:r,value:i[s]});else i!==null&&typeof i!="undefined"&&n.push({name:this.name,value:i})});return e.param(n)};e.fn.fieldValue=function(t){for(var n=[],r=0,i=this.length;r<i;r++){var s=this[r],o=e.fieldValue(s,t);if(o===null||typeof o=="undefined"||o.constructor==Array&&!o.length)continue;o.constructor==Array?e.merge(n,o):n.push(o)}return n};e.fieldValue=function(t,n){var r=t.name,i=t.type,s=t.tagName.toLowerCase();n===undefined&&(n=!0);if(n&&(!r||t.disabled||i=="reset"||i=="button"||(i=="checkbox"||i=="radio")&&!t.checked||(i=="submit"||i=="image")&&t.form&&t.form.clk!=t||s=="select"&&t.selectedIndex==-1))return null;if(s=="select"){var o=t.selectedIndex;if(o<0)return null;var u=[],a=t.options,f=i=="select-one",l=f?o+1:a.length;for(var c=f?o:0;c<l;c++){var h=a[c];if(h.selected){var p=h.value;p||(p=h.attributes&&h.attributes.value&&!h.attributes.value.specified?h.text:h.value);if(f)return p;u.push(p)}}return u}return e(t).val()};e.fn.clearForm=function(){return this.each(function(){e("input,select,textarea",this).clearFields()})};e.fn.clearFields=e.fn.clearInputs=function(){return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();e=="text"||e=="password"||t=="textarea"?this.value="":e=="checkbox"||e=="radio"?this.checked=!1:t=="select"&&(this.selectedIndex=-1)})};e.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})};e.fn.enable=function(e){e===undefined&&(e=!0);return this.each(function(){this.disabled=!e})};e.fn.selected=function(t){t===undefined&&(t=!0);return this.each(function(){var n=this.type;if(n=="checkbox"||n=="radio")this.checked=t;else if(this.tagName.toLowerCase()=="option"){var r=e(this).parent("select");t&&r[0]&&r[0].type=="select-one"&&r.find("option").selected(!1);this.selected=t}})}})(jQuery);